
Training Epoch 1:   0%|                                           | 0/567 [00:00<?, ?it/s]
Train start !
























































































































































































































































































































































































































































































































































































Testing Epoch 1:   0%|                                            | 0/567 [00:00<?, ?it/s]























































































































































































































































































































































































































































































































































































Testing Epoch 1: 100%|███████████████████████████████▉| 566/567 [1:21:33<00:08,  8.75s/it]
[Epoch 1 Test Metrics]
AUC=0.6055, MRR=0.2432, nDCG@5=0.2395, nDCG@10=0.3097, avg=0.3495, (empty batch=0)
[EarlyStopping] Initialize best_score = 0.349459
[EarlyStopping] Best model saved: /home/user/pyo/Adressa_7w/test/2_hop_no_val_ckpt/bs_150_lr_0.0001/best_epoch_1_lr_0.0001_embdim_300_avgscore_0.3495.pth
























































































































































































































































































































































































































































































































































































Testing Epoch 2:   0%|                                            | 0/567 [00:00<?, ?it/s]






















































































































































































































































































































































































































































































































































































Testing Epoch 2: 100%|███████████████████████████████▉| 566/567 [1:22:29<00:08,  8.68s/it]
[Epoch 2 Test Metrics]
AUC=0.6230, MRR=0.2403, nDCG@5=0.2379, nDCG@10=0.3129, avg=0.3535, (empty batch=0)
[EarlyStopping] score improved to 0.353545 at epoch=2. Reset counter.
[EarlyStopping] Best model saved: /home/user/pyo/Adressa_7w/test/2_hop_no_val_ckpt/bs_150_lr_0.0001/best_epoch_2_lr_0.0001_embdim_300_avgscore_0.3535.pth





















































































































































































































Traceback (most recent call last):
  File "model/main_for_2hop_no_validation.py", line 364, in <module>
    print(f"\n[Training Completed] Best Test Performance (epoch={early_stopper.best_epoch}):")
  File "model/main_for_2hop_no_validation.py", line 229, in main
    batch_cnt = len(train_news)
  File "/home/user/anaconda3/envs/pio/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1120, in _call_impl
    result = forward_call(*input, **kwargs)
  File "/home/user/pyo/Rec-with-TKG/model/GCRNN_for_2hop.py", line 322, in forward
    ent_embs = self.seq_GCRNN_batch(g, sub_g, latest_train_time, seed_list, history_length)
  File "/home/user/pyo/Rec-with-TKG/model/GCRNN_for_2hop.py", line 211, in seq_GCRNN_batch
    g.ndata['node_emb'][self.user_num:] = self.News_Encoder(self.all_news_ids)
  File "/home/user/pyo/Rec-with-TKG/model/GCRNN_for_2hop.py", line 93, in News_Encoder
    nv = self.news_encoder(title_tensor, category_idx, subcategory_idx)  # shape: (1, num_filters) 가 되도록 내부 처리
  File "/home/user/anaconda3/envs/pio/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/pyo/Rec-with-TKG/utils/full_news_encoder.py", line 47, in forward
    if (category_idx >= self.config.num_categories) or (category_idx < 0):
TypeError: keyboard_interrupt_handler() takes 1 positional argument but 2 were given